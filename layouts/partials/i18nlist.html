{{/* Dynamic Language Switcher Component Features: - Uses Hugo's built-in
language configuration from hugo.toml - Automatically hides when only one
language is configured - Uses flags from data/site_config.yaml for visual
enhancement - Respects show_language_switcher parameter - Properly handles any
default language configuration Configuration: - Languages: Configure in
hugo.toml [languages] section - Flags: Optional enhancement via
data/site_config.yaml - Toggle: Set params.show_language_switcher = false to
disable */}} {{ $showSwitcher := .Site.Params.show_language_switcher }} {{
$siteConfig := .Site.Data.site_config }} {{/* Only show language switcher if: 1.
show_language_switcher is not false 2. More than one language is configured in
hugo.toml */}} {{ if and (ne $showSwitcher false) (gt (len .Site.Languages) 1)
}}
<div class="language-dropdown dib mr3">
  <div class="language-parent">
    {{/* Dropdown trigger with arrow */}}
    <span
      class="lang-toggle hover-white white-90 no-underline f5 f4-ns fw4 pv2 ph3 pointer"
      role="button"
      tabindex="0"
      aria-haspopup="true"
      aria-expanded="false"
    >
      Languages ‚ñæ
    </span>

    {{/* Language options dropdown */}}
  <ul class="language-submenu" hidden>
      {{/* Dynamic per-page translation linking:
           For each configured language, if the current page has a translation
           in that language, link to it. Otherwise fall back to that language's
           home page (root for default language, /code/ for others).
       */}}
  {{ $currentPage := . }}
  {{ $currentLang := .Site.Language.Lang }}
  {{ $weightOne := where $.Site.Languages "Weight" 1 }}
  {{ $defaultLang := (cond (gt (len $weightOne) 0) ((index $weightOne 0).Lang) $currentLang) }}
      {{ range .Site.Languages }}
        {{ $langCode := .Lang }}
        {{ $langName := .LanguageName }}
        {{/* Flag lookup */}}
        {{ $flag := "üåê" }}
        {{ if $siteConfig }}
          {{ $langConfig := index $siteConfig.languages $langCode }}
          {{ if $langConfig }}{{ $flag = $langConfig.flag }}{{ end }}
        {{ end }}
        {{/* Determine target URL */}}
  {{ $url := "" }}
        {{ if eq $langCode $currentLang }}
          {{/* Current language: stay on this page */}}
          {{ $url = $currentPage.RelPermalink }}
        {{ else }}
          {{/* Attempt to find a translation page with matching lang */}}
          {{ $candidates := where $currentPage.Translations "Lang" $langCode }}
          {{ if gt (len $candidates) 0 }}
            {{ $url = (index $candidates 0).RelPermalink }}
          {{ else }}
            {{ if eq $langCode $defaultLang }}
              {{ $url = "/" }}
            {{ else }}
              {{ $url = printf "/%s/" $langCode }}
            {{ end }}
          {{ end }}
        {{ end }}
        <li class="language-item">
          <a
            href="{{ $url }}"
            class="language-link {{ if eq $langCode $currentLang }}current{{ end }}"
            title="{{ $langName }}"
            lang="{{ $langCode }}"
          >
            <span class="flag">{{ $flag }}</span>
            <span class="language-name">{{ $langName }}</span>
          </a>
        </li>
      {{ end }}
    </ul>
  </div>
</div>
{{ end }}
